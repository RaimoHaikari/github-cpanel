<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>cPanelin ja Github Actions</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital@0;1&family=Padauk&family=Source+Code+Pro&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/style.css">
  </head>
  <body>
    <div class="ulkokeha">

        <section>
            <div class="leipateksti">
                <h1>Webhotellin p√§ivitys cPanelin ja Github Actionsin avulla</h1>
            </div>
            <div class="marginaali"></div>            
        </section>

        <section>
            <div class="leipateksti">
                <p class="lead">
                    T√§m√§ opas kertoo kuinka kotisivut voidaan tallentaa webhotellin palvelimelle Github Actionsien avulla 
                    ja kuinka niiden sis√§lt√∂√§ p√§ivitet√§√§n samaa menetelm√§√§ k√§ytt√§en.
                </p>
                <p>
                    Oppaan esimerkki ei ole ‚Äúainoa ja oikea tapa toimia‚Äù, vaan on tarkoitettu antamaan suuntaa t√§m√§n kaltaisen pulman eteen joutuvalle. 
                    Kaiken voi tehd√§ paremmin, mutta jostain on aina aloitettava.
                </p>
                <p>
                    Tehd√§√§n siis yksinkertainen kotisivu, joka tallennetaan n√§ht√§ville Webhotellin palvelimelle.
                </p>
                <p>
                    Projekti toteutetaan siten, ett√§ omalla koneella on ty√∂n alla oleva sivuston kehitysversio, 
                    josta sitten projektin edetess√§ voidaan julkaista palvelimelle n√§ht√§ville tuotantoversioita.
                </p>
            </div>
            <div class="marginaali"></div>
        </section>

        <section class="hideFromSmallScreens">
            <div class="leipateksti">
                <p>
                    Oppaan vasemmassa marginaalissa n√§ytet√§√§n muistio, johon ty√∂n edess√§ ker√§t√§√§n my√∂hemmin tarvittavia tietoja. 
                    Jos seuraat mukana, niin korvaa esimerkkiarvot omaa tilannettasi paremmin kuvaavilla.
                </p>
            </div>
            <div class="marginaali"></div>            
        </section>

        <section>
            <div class="leipateksti">
                <h2>L√§ht√∂oletukset</h2>
                <p>Oppaan suorittaminen edellytt√§√§, ett√§:</p>
                <ul>
                    <li>k√§yt√∂ss√§si on <a href="https://fi.wikipedia.org/wiki/CPanel" target="_blank">cPanelia</a> tukeva Webhotelli</li>
                    <li>sinulla on <a href="https://github.com/" target="_blank">GitHub-tili</a></li>
                    <li>koneellesi on asennettu <a href="https://git-scm.com/" target="_blank">Git-versionhallintaohjelmisto</a>.</li>
                </ul>
                <p>Mik√§li edellytykset ovat kunnossa, l√§hdet√§√§n liikkeelle suorittamalla cPanelissa tarvittavat ennakkovalmistelut.</p>
            </div>
            <div class="marginaali">

                <div class="notes">
                    <p>Muistiinpanot</p>
                    <ul>
                        <li><span class="memoLabel">FTP -osoite</span> ftp.tahtisadetta.fi</li>
                    </ul>
                </div>

            </div>            
        </section>


        <section>

            <div class="leipateksti">
                <h2>cPanel</h2>

                <p>Luodaan t√§t√§ projektia varten cPanelilla alidomain (subdomain), jonka alle tiedostot tullaan tallentamaan.</p>
                <p>
                    cPanelin p√§√§sivun DOMAINS-v√§lilehdelt√§ l√∂ytyy <em>Subdomains-painike</em>. Painike avaa Subdomains n√§kym√§n, 
                    joka sis√§lt√§√§ lomakkeen, jonka avulla alidomaineja voidaan lis√§t√§.
                </p>

                <figure>
                    <img src="./images/cpanel-DOMAINS.png" alt="cPanel Domains-v√§lilehti" />
                    <figcaption>cPanel Domains-v√§lilehti.</figcaption>
                </figure>
                

                <p>
                    Lomakkeen Subdomain-kent√§n avulla m√§√§ritet√§√§n mink√§ niminen subdomain halutaan lis√§t√§, jonka j√§lkeen <em>Create-painikkeen</em> 
                    painallus lis√§√§ uuden alidomainin. 
                </p>

                <figure>
                    <img src="./images/cpanel-create-subdomain.png" alt="cPanel lis√§√§ uusi Subdomain lomake" />
                    <figcaption>Kuvan esimerkiss√§ luodaan <em>calixtus</em> niminen alidomain ja sijoitetaan alidomainin tiedostot <em>calixtus</em> nimiseen alihakemistoon.</figcaption>
                </figure>

                <p>Mik√§li toimenpide onnistui, ilmaantuu luotu alidomain sivun alalaidassa esitett√§v√§√§n listaan:</p>

                <figure>
                    <img src="./images/cpanel-create-subdomain-listing.png" alt="cPanel Subdomain listaus" />
                    <figcaption>cPanel Subdomain listaus.</figcaption>
                </figure>

                <p>cPanelin p√§√§sivulla FILES-v√§lilehdelt√§ l√∂ytyy <em>Filemanager-painike</em>. Painike avaa tiedostojen hallintaa toimittavan File Manager -n√§kym√§n.</p>
                <figure>
                    <img src="./images/cpanel-FILES.png" alt="cPanel Files v√§lilehti" />
                    <figcaption>cPanel Files-v√§lilehti.</figcaption>
                </figure>



                <p>Hakemistojen joukkoon on ilmestynyt uusi hakemisto, johon juuri luodun alidomainin sis√§lt√∂ tallennetaan.</p>

                <figure>
                    <img src="./images/cpanel-filemanager.png" alt="cPanel Filemanager" />
                    <figcaption>cPanel:in tiedostolistaus</figcaption>
                </figure>


                
            </div>

            <div class="marginaali">

                <div class="notes">
                    <p>Muistiinpanot</p>
                    <ul>
                        <li><span class="memoLabel">FTP -osoite</span> ftp.tahtisadetta.fi</li>
                        <li><span class="memoLabel">Subdomain</span> calixtus</li>
                    </ul>
                </div>
            </div>      

        </section>

        <section>
            <div class="leipateksti">
                <p>Seuraavaksi luodaan FTP-tunnukset, joiden avulla GitHub:sta k√§sin voidaan olla yhteydess√§ Web-palvelimelle.</p>

                <figure>
                    <img src="./images/cpanel-create-ftpAccountCALIXTUS.png" alt="cPanel FTP -k√§ytt√§j√§tunnuksen luominen" />
                    <figcaption>Kuvassa lis√§t√§√§n k√§ytt√§j√§lle <em>tiburtius</em> FTP -tili ja oletushakemistoksi asetetaan <em>public_html/calixtus</em>. 
                        Salasanaa asetettaessa voit pyyt√§√§ cPanelia luomaan sinulle salasanan. Talleta salasana jonnekkin, 
                        tarvitset sit√§ pian kun GitHub:ssa m√§√§ritet√§√§n automaattisen p√§ivityksen edellytt√§m√§t FTP -asetukset.</figcaption>
                </figure>

                <p>
                    Mik√§li tilin luominen onnistuu, ilmestyy luotu tili sivun alalaidassa esitett√§v√§√§ FTP -tilien listaan:
                </p>

                <figure>
                    <img src="./images/cpanel-create-ftpAccount-added.png" alt="Lis√§tty FTP -tunnus n√§kyy listassa." />
                    <figcaption>Lis√§tty FTP -tunnus n√§kyy listassa.</figcaption>
                </figure>

                <p>Kopio <em>Log In -sarakkeessa</em> n√§kyv√§ <em>k√§ytt√§j√§nimi</em> talteen GitHub asetuksia varten.</p>
                <p>Webhotellin puolella ollaan nyt valmiita ottamaan sivut vastaan.</p>
            </div>

            <div class="marginaali">

                <div class="notes">
                    <p>Muistiinpanot</p>
                    <ul>
                        <li><span class="memoLabel">FTP -osoite</span> ftp.tahtisadetta.fi</li>
                        <li><span class="memoLabel">Subdomain</span> calixtus</li>
                        <li><span class="memoLabel">K√§ytt√§j√§</span> tiburtius@tahtisadetta.fi</li>
                        <li><span class="memoLabel">Salasana</span> HeyfZcy5eu</li>
                    </ul>
                </div>

            </div>    

        </section>

        <section>
            <div class="leipateksti">

                <h2>GitHub</h2>

                <p>Luodaan uusi GitHub repository.</p>

                <figure>
                    <img src="./images/github-create-repository.png" alt="Luodaan uusi GitHub repository." />
                    <figcaption>Lomake, jonka avulla luodaan uusi GitHub repository.</figcaption>
                </figure>

                <p>
                    Kuvassa ollaan luomassa GitHub repositorya, jonka nimeksi tulee <em>ajan-lasku</em>. Nime√§ valitessa on syyt√§ pit√§√§ mieless√§, 
                    ett√§ seuraavassa vaiheessa meid√§n pit√§√§ perustaa vastaavan niminen hakemisto omalle koneelle. 
                    T√§t√§ hakemistoa tullaan k√§ytt√§m√§√§n projektin ty√∂hakemistona.
                </p>

                <p>
                    Repositoryn luomisen j√§lkeen aukeaa n√§kym√§, jossa on listattuna vaihtoehtoja, joita uuden repositoryn luomisen yhteydess√§ 
                    tyypillisesti tehd√§√§n seuraavaksi. 
                    Kopioidaan vaihtoehdoista <em>..or push an existing repository from the command line</em> talteen my√∂hemp√§√§ k√§ytt√∂√§ varten.
                </p>

                <pre>
    git remote add origin https://github.com/RaimoHaikari/ajan-lasku.git
    git branch -M main
    git push -u origin main
                </pre>

                <p>
                    <span class="emphasizedText">
                        Huom! Sinulla ensimm√§isell√§ rivill√§ oleva sanan origin j√§lkeen lukeva osuus vastaa sinun luomasi repositoryn nime√§.
                    </span>
                </p>

                <p>
                    Jatketaan edelleen GitHub:in parissa ja valitaan <em>Settings-v√§lilehti</em>. 
                    Kun aukeavan sivun vasemman laidan valikosta valitaan kohta <em>Secrets</em> ja edelleen alavalinta <em>Actions</em>, aukeaa n√§kym√§, 
                    jonka kautta voidaan sy√∂tt√§√§ FTP -p√§ivityksess√§ tarvittavat tiedot.
                </p>
            
                <figure>
                    <img src="./images/github-settings-actions-secrets.png" alt="Repositoryn Secrets-asetukset" />
                    <figcaption>Repositoryn Secrets-asetukset.</figcaption>
                </figure>
                
                <p>T√§m√§ tapahtuu <em>New repository secret-painikkeen</em> avulla.</p>

            </div>

            <div class="marginaali"></div>            
        </section>


        <section>
            <div class="leipateksti">
                <p>Talletetaan kolme salaisuutta:</p>
                <ol>
                    <li>ftp_server<span class="ml emphasizedText">(Muistiinpanojen FTP -osoite)</span></li>
                    <li>ftp_name<span class="ml emphasizedText">(Muistiinpanojen K√§ytt√§j√§)</span></li>
                    <li>ftp_password<span class="ml emphasizedText">(Muistiinpanojen Salasana)</span></li>
                </ol>

                <p>Salaisuudet sy√∂tet√§√§n yksi kerrallaan.</p>

                <figure>
                    <img src="./images/github-settings-actions-secrets-add.png" alt="Secrets-asetuksen lis√§√§minen" />
                    <figcaption>Kuvassa ollaan sy√∂tt√§m√§ss√§ ftp_server salaisuutta.</figcaption>
                </figure>

                <p>Kun kaikki kolme salaisuutta on talletettu, sivun alalaidassa pit√§√§ sivun alalaidassa n√§ky√§ oheisen kaltainen listaus.</p>

                <figure>
                    <img src="./images/github-settings-actions-secrets-THREE-ADDED.png" alt="Lista tallennetuista salaisuuksista" />
                    <figcaption>Lista tallennetuista salaisuuksista.</figcaption>
                </figure>

                <p>Jatketaan omalla koneella suoritettavan osion pariin.</p>

            </div>
            <div class="marginaali">
                <div class="notes">
                    <p>Muistiinpanot</p>
                    <ul>
                        <li><span class="memoLabel">FTP -osoite</span> ftp.tahtisadetta.fi</li>
                        <li><span class="memoLabel">Subdomain</span> calixtus</li>
                        <li><span class="memoLabel">K√§ytt√§j√§</span> tiburtius@tahtisadetta.fi</li>
                        <li><span class="memoLabel">Salasana</span> HeyfZcy5eu</li>
                        <li><span class="memoLabel">Repository</span> ajan-lasku</li>
                    </ul>
                </div>
            </div>            
        </section>

        
        <section>
            <div class="leipateksti">
                <h2>Kehitysversio</h2>
                <p>
                    Omalle koneelle luodaan GitHub repositoryn kanssa t√§sm√§lleen saman niminen hakemisto. 
                    Minun tapauksessani alihakemiston nimen pit√§√§ olla: <em>ajan-lasku</em>.
                </p>
                <pre>
    mkdir ajan-lasku
                </pre>
                <p>
                    Siirryt√§√§n kyseisen kansion sis√§lle ja tehd√§√§n kansiosta Git-projekti:
                </p>
                <pre>
    cd ajan-lasku
    git init
                </pre>
                <p>
                    Luodaan saman tien index.html tiedosto. Sen sis√§ll√∂ksi voi kopioida vaikka seuraavan koodinp√§tk√§n:
                </p>

                <pre>
    &lt;!DOCTYPE html&gt;
    &lt;html lang="en"&gt;
        &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
        &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;
        &lt;title&gt;Suomalaisten vanha ajanlasku&lt;/title&gt;
        &lt;/head&gt;
        &lt;body&gt;
        &lt;h1&gt;Viikkolaskuj√§rjestelm√§&lt;/h1&gt;
        &lt;p&gt;Vuosi jakaantui kahteen puolikkaaseen, talveen ja kes√§√§n.&lt;/p&gt;
        &lt;ul&gt;
            &lt;li&gt;Ensimm√§inen talvip√§iv√§ oli Calixtuksen p√§iv√§n√§ 14. lokakuuta&lt;/li&gt;
            &lt;li&gt;ensimm√§inen kes√§p√§iv√§ oli Tiburtiuksen p√§iv√§n√§ huhtikuun 14:nten√§.&lt;/li&gt;
        &lt;/ul&gt;
        &lt;/body&gt;
    &lt;/html&gt;
                </pre>

                <p>T√§m√§n j√§lkeen lis√§t√§√§n kaksi hakemistoa: ensiksi <em>.github</em> ja t√§m√§n hakemiston sis√§√§n: <em>workflows</em></p>
                <p><em>workflows</em> hakemiston sis√§√§n luodaan <em>actions.yml</em> niminen tiedosto. T√§ss√§ tiedostossa m√§√§ritell√§√§n toimenpiteet, jotka GitHub:in halutaan suorittavan.</p>
                <p>actions.yml tiedoston sis√§ll√∂ksi kopioidaan seuraava json -koodi:</p>
                <pre>
    on: push
    name: üöÄ Deploy website on push
    jobs:
        web-deploy:
        name: üéâ Deploy
        runs-on: ubuntu-latest
        steps:
        - name: üöö Get latest code
            uses: actions/checkout@v2
        
        - name: üìÇ Sync files
            uses: SamKirkland/FTP-Deploy-Action@4.3.2
            with:
            server: ${{ secrets.ftp_server }}
            username: ${{ secrets.ftp_name }}
            password: ${{ secrets.ftp_password }}
                </pre>
                <p>
                    Koodi on per√§isin osoitteesta: <a href="https://github.com/marketplace/actions/ftp-deploy" target="_blank">https://github.com/marketplace/actions/ftp-deploy</a>. 
                    Kyseisell√§ sivulla esitell√§√§n automaattista, FTP:n avulla suoritettavaa p√§ivityst√§ ja listataan tyypillisten k√§ytt√∂tilanteiden malleja.
                </p>
                <p>Huomiota kannattaa kiinnitt√§√§ koodinp√§tk√§n kolmeen viimeiseen riviin:</p>
                <ul>
                    <li>secrets.ftp_server</li>
                    <li>secrets.ftp_name</li>
                    <li>secrets.ftp_password</li>
                </ul>
                <p>
                    Ne vastaavat GitHub repositoryn luomisen yhteydess√§ tallennettuja salaisuuksia.
                </p>
                 <p>
                    Projektin juuresta k√§si tilanteen pit√§isi n√§ytt√§√§ suurin piirtein seuraavalta:
                 </p>

                 <figure>
                    <img src="./images/myComputer-project-contents.png" alt="Hakemistolistaus projektin juuresta k√§sin tarkasteltuna" />
                    <figcaption>Hakemistolistaus projektin juuresta k√§sin tarkasteltuna.</figcaption>
                </figure>

                 



                 <p>Olemme valmiita tallettamaan tehdyt muutokset GitHub-repositoryyn.</p>
                 <p>Lis√§t√§√§n tehdyt muutokset committiin:</p>
                 <pre>
    git add .
    git commit -m 'Projektin avaus'
                 </pre>

                 <p>Yhdistet√§√§n projekti GitHub repositoryyn:</p>

                 <pre>
    git remote add origin https://github.com/RaimoHaikari/ajan-lasku.git
                 </pre>

                 <p><span class="emphasizedText">Sinulla originin j√§lkeen tulevan osuuden pit√§√§ vastaa omaa repositoryasi!</span></p>

                 <p>
                    Pushataan tehdyt muutokset GitHub:iin:
                 </p>

                 <pre>
    git branch -M main
    git push -u origin main
                 </pre>

                 <p>Jos kaikki sujui hyvin, niin ensimm√§isen p√§ivityksen j√§lkeen:</p>
                 <p>GitHub:in Code-v√§lilehti n√§ytt√§√§ seuraavan kaltaiselta:</p>
                 <figure>
                    <img src="./images/github-CODE-after-first-commit.png" alt="GitHub Code-v√§lilehti ensimm√§isen p√§ivityksen j√§lkeen" />
                    <figcaption>GitHub Code-v√§lilehti ensimm√§isen p√§ivityksen j√§lkeen.</figcaption>
                 </figure>
                 <p>GitHub:in Actions-v√§lilehdell√§ vallitsee jotakuinkin seuraava tilanne:</p>
                 <figure>
                    <img src="./images/github-ACTIONS-after-first-commit.png" alt="GitHub Actions-v√§lilehti ensimm√§isen p√§ivityksen j√§lkeen" />
                    <figcaption>GitHub Actions-v√§lilehti ensimm√§isen p√§ivityksen j√§lkeen.</figcaption>
                 </figure>
                 <p>Luotu kotisivu n√§kyy cPanel:in tiedostolistauksessa:</p>
                 <figure>
                    <img src="./images/cpanel-FILEMANAGER-AFTER-FIRST-commit.png" alt="cPanel tiedostolistaus ensimm√§isen p√§ivityksen j√§lkeen" />
                    <figcaption>cPanel tiedostolistaus ensimm√§isen p√§ivityksen j√§lkeen.</figcaption>
                 </figure>
                 <p>Ja luotu alidomain on valmiina kaiken kansan tarkasteltavaksi:</p>
                 <figure>
                    <img src="./images/web-AFTER-FIRST-COMMIT.png" alt="Kotisivut n√§ht√§vill√§ ensimm√§isen p√§ivityksen j√§lkeen" />
                    <figcaption>Kotisivut n√§ht√§vill√§ ensimm√§isen p√§ivityksen j√§lkeen.</figcaption>
                 </figure>
            </div>
            <div class="marginaali">
                <div class="notes">
                    <p>Muistiinpanot</p>
                    <ul>
                        <li><span class="memoLabel">FTP -osoite</span> ftp.tahtisadetta.fi</li>
                        <li><span class="memoLabel">Subdomain</span> calixtus</li>
                        <li><span class="memoLabel">K√§ytt√§j√§</span> tiburtius@tahtisadetta.fi</li>
                        <li><span class="memoLabel">Salasana</span> HeyfZcy5eu</li>
                        <li><span class="memoLabel">Repository</span> ajan-lasku</li>
                    </ul>
                </div>
            </div>            
        </section>
    
        
        <section>
            <div class="leipateksti">
                <h2>Loppusanat</h2>
                <p>Kun latu on saatu avattua, niin kehitysversiossa tehdyt muutokset saadaan nyt helposti p√§ivitetty√§ kotisivuille.</p>
                <p>T√§ll√∂in riitt√§v√§t seuraavat Git-k√§skyt:</p>
                <pre>
    git add .
    git commit -m 'Kuvaus tehdyist√§ muutoksista'
    git push -u origin main
                </pre>
                <p>
                    Joka ainoaa muutosta ei tietenk√§√§n kannata erikseen p√§ivitt√§√§ n√§ht√§ville, vaan p√§ivityksi√§ on j√§rkev√§mp√§√§ hoitaa paketteina, 
                    joissa on koottu yhteen mielekk√§it√§ kokonaisuuksia. Seuraavaksi kannattaakin ottaa selv√§√§ 
                    versionhallinnan <a href="https://www.w3schools.com/git/git_branch.asp" target="_blank">branch-ominaisuudesta</a> 
                    ja siit√§ kuinka t√§t√§ ominaisuutta voidaan hy√∂dynt√§√§ GitHub Actionseja koostettaessa.
                </p>
            </div>
            <div class="marginaali"></div>            
        </section>
    


    </div>
    
  </body>
</html>